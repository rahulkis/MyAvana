@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper AuthoringTagHelpers.TagHelpers.EmailTagHelper, AuthoringTagHelpers
@inject MyAvanaQuestionaireApiClient.ApiClient calender
@{
    var data = calender.GetTime();

}

<script src="~/js/LiveSchedule/Schedule.js"></script>
<script type="text/javascript">
    var showOrderNumber = false;
    function paymentToDo(haveKit) {
        showOrderNumber = haveKit;
        if (!haveKit) {
            $("span.consultationPrice").html("$0 USD");
            $("#btnProceedPayment").html("Proceed");
            $("#divOrderNumber").css("display", "block");
            $("#divPayment").css("display", "none");
        }
        else {
            $("span.consultationPrice").html("$45 USD");
            $("#btnProceedPayment").html("Proceed to Payment");
            $("#divOrderNumber").css("display", "none");
            $("#divPayment").css("display", "block");
        }
    }
</script>
<div id="progressbar">

    <ul class="nav nav-pills hairkit_tabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link btn active" id="nothave_kit" data-toggle="pill" href="#nothave_kit" role="tab" aria-controls="nothave_kit" aria-selected="true" onclick="paymentToDo(true)">I don't have a Hair Kit</a>
        </li>
        <li class="nav-item ml-3">
            <a class="nav-link btn " id="have_kit" data-toggle="pill" href="#have_kit" role="tab" aria-controls="have_kit" aria-selected="false" onclick="paymentToDo(false)">I have a Hair Kit</a>
        </li>
    </ul>
    <div class="hairtext_img">
       <img src="/images/text_img.png" alt="img"/>
    </div>
    <fieldset id="divWelcome" class="active">
        <div class="centertextdiv justify-content-start fieldset1">
            <div class="container-fluid h-100">
                <div class="row h-100">
                    <div class="col-lg-4 leftdiscription">
                        <div class="leftdiscription_inner">
                            <h2 class="desc_heading">Myavana Hair Coaching Session</h2>
                            <ul class="disc_list" id="disc_list">
                                <li>
                                    30 min
                                </li>
                                <li>
                                    Web conferencing details provided upon confirmation.
                                </li>
                                <li>
                                    <span class="consultationPrice">$45 USD</span>
                                </li>
                                @*<li id="resultdatetimezone">

                                    </li>
                                    <li id="Timezonetext">

                                    </li>*@
                            </ul>
                            <p>We look forward to chatting more about your hair goals! On our video consultation call, we'll discuss your current hair challenges and share some personalized expert tips that you can begin implementing right away.</p>
                            <p>We can go over a number of topics that are most impotant for you right now such as:</p>
                            <ul class="dot_list">
                                <li>Cleansing process</li>
                                <li>Conditioning process</li>
                                <li>Treatment/Damage</li>
                                <li>Hair challanges</li>
                                <li>Product Recommendations</li>
                                <li>Regiments, and more.</li>
                            </ul>
                            <p>If you choose to purchase the hair analysis kit, the consultation free($45) will be applied to your purchase</p>
                            <p>Please find a time that's most convenient for you. I look forward to speaking with you soon!</p>
                        </div>
                    </div>
                    <div class="col-lg-8 form_div">
                        <div class=" form_div_inner">
                            <div class="back_icons mb-5 previous">
                                <a href="#"><i class="fa fa-angle-left" aria-hidden="true"></i></a>
                            </div>
                            <div class="form_box">

                                <div class="row">
                                    <div class="col-lg-7">
                                        <h4 class="form_heading">
                                            Select Date
                                        </h4>
                                        <div id="datepicker" class="calendar"></div>
                                        <div class="timezone">
                                            <select class="timezone_select">
                                                @for (int i = 0; i < data.Result.TimeZones.Count(); i++)
                                                {
                                                    <option id="optionTimezone" name="difftimezones">
                                                        @data.Result.TimeZones[i].Timezones
                                                    </option>
                                                }

                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-lg-4 offset-lg-1">
                                        <h4 class="form_heading">
                                            Select Time
                                        </h4>
                                        <div class="time_slot">
                                            <h3 class="mb-4" id="datetimetext"></h3>
                                            <div class="button-group-pills text-center time_slot_wrapper" data-toggle="buttons">
                                                @for (int i = 0; i < data.Result.Time.Count(); i++)
                                                {
                                                    <label class="btn btn-default timeslotstextselected">
                                                        <input type="radio" id="@data.Result.Time[i].ScheduleTimeId" name="optionsTimeslots" value="@data.Result.Time[i].Time" />
                                                        <div>@data.Result.Time[i].Time</div>
                                                    </label>
                                                }

                                            </div>
                                            <button type="button" onclick="validateDateTime()" class="valchangeonconfirm form_btn" id="cnfbtn">Confirm</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>

    <fieldset class="inActive">
        <div class="centertextdiv justify-content-start fieldset2">
            <div class="container-fluid h-100">
                <div class="row h-100">
                    <div class="col-lg-4 leftdiscription">
                        <div class="leftdiscription_inner">
                            <h2 class="desc_heading">Myavana Hair Coaching Session</h2>
                            <ul class="disc_list" id="disc_list">
                                <li>
                                    30 min
                                </li>
                                <li>
                                    Web conferencing details provided upon confirmation.
                                </li>
                                <li>
                                    <span class="consultationPrice">$45 USD</span>
                                </li>
                                <li id="resultdatetimezone">

                                </li>
                                <li id="Timezonetext">

                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-8 form_div">
                        <div class=" form_div_inner">
                            <div class="back_icons mb-5">
                                <a href="#"><i class="fa fa-angle-left" aria-hidden="true"></i></a>
                            </div>
                            <form class="form_box" id="myform">
                                <h4 class="form_heading">
                                    Enter Details
                                </h4>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="form-group">
                                                    <label>Name <sup>*</sup></label>
                                                    <input class="form-control" type="text" id="myFormName" name="myFormName" required />
                                                </div>
                                            </div>
                                            <div class="col-lg-12">
                                                <div class="form-group">
                                                    <label>Email <sup>*</sup></label>
                                                    <input class="form-control" value="@Model.UserEmail" disabled type="email" id="myFormEmail" required />
                                                </div>
                                            </div>
                                            <div class="col-lg-12">
                                                <div class="form-group">
                                                    <label>Phone Number <sup>*</sup></label>
                                                    <input class="form-control" type="number" id="myFormPhone" required />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="form-group">
                                                    <label>What would you like to focus on in this hair consultation?<sup>*</sup></label>
                                                    <textarea class="form-control" rows="4" id="myFormtextarea" required></textarea>
                                                </div>
                                            </div>
                                            <div class="col-lg-12">
                                                <div class="form-group">
                                                    <label>Send text message to</label>
                                                    <input class="form-control" type="number" id="myFormText" required />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <button type="button" class="form_btn" id="btnProceedPayment" onclick="validateUser()">Proceed to Payment</button>
                                    </div>
                                </div>
                            </form>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>
    <fieldset id="divWel" class="inActive">
        <div class="centertextdiv justify-content-start fieldset3">
            <div class="container-fluid h-100">
                <div class="row h-100">
                    <div class="col-lg-4 leftdiscription">
                        <div class="leftdiscription_inner">
                            <h2 class="desc_heading">Myavana Hair Coaching Session</h2>
                            <ul class="disc_list" id="disc_list">
                                <li>
                                    30 min
                                </li>
                                <li>
                                    Web conferencing details provided upon confirmation.
                                </li>
                                <li>
                                    <span class="consultationPrice">$45 USD</span>
                                </li>
                                <li id="resultdatetimezone1">

                                </li>
                                <li id="Timezonetext1">

                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-8 form_div">

                        <div class=" form_div_inner"><div id="divOrderNumber" style="display:none">
    <div class="back_icons mb-5 previous">
        <a href="#"><i class="fa fa-angle-left" aria-hidden="true"></i></a>
    </div>

    <div class="order-num_section">
        <h2 class="desc_heading mb-4">Enter Your Order Number</h2>
        <div class="form-group">
            <label>Order number*</label>
            <input type="text" class="form-control" />
        </div>

        <button class="btn btn-confirm_order" onclick="confirmOrderNumber()">Confirm</button>

    </div>
</div><div id="divPayment">
    <div class="form_box">
        <h4 class="form_heading">
            Payment
        </h4>
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Card</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Paypal</a>
            </li>

        </ul>
        <div class="tab-content pt-3" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label>Cardholder Name <sup>*</sup></label>
                            <input id="txtCardName" class="form-control" type="text">
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label>Card Number <sup>*</sup></label>
                            <input id="txtCardNumber" class="form-control" type="number">
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="form-group">
                            <label>Expiration Date <sup>*</sup></label>
                            <div class="expire_dropdown">
                                <select id="expireYear" class="form-control">
                                    <option value="0">-- select year --</option>
                                    <option value="2021">2021</option>
                                    <option value="2022">2022</option>
                                    <option value="2023">2023</option>
                                    <option value="2024">2024</option>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                    <option value="2030">2030</option>
                                    <option value="2031">2031</option>
                                    <option value="2032">2032</option>
                                </select>
                                <select id="expireMonth" class="form-control">
                                    <option value="0">-- select month --</option>
                                    <option value="01">January</option>
                                    <option value="02">February</option>
                                    <option value="03">March</option>
                                    <option value="04">April</option>
                                    <option value="05">May</option>
                                    <option value="06">June</option>
                                    <option value="07">July</option>
                                    <option value="08">August</option>
                                    <option value="09">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                    <option>fab</option>
                                    <option>march</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="form-group">
                            <label>CVV <sup>*</sup></label>
                            <input id="txtCvv" class="form-control" type="number">
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="secure_info">
                            <p><i class="fa fa-lock" aria-hidden="true"></i> Your payment data is encrypted and secure.</p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="d-flex font-bold justify-content-between text-dark">
                            <span>TOTAL PRICE</span>
                            <span>$45</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <button type="button" onclick="PayViaStripe()" class="form_btn">Pay and Schedule Event</button>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">

                <div class="row">
                    <div class="col-lg-6">
                        <hr>
                        <div class="d-flex font-bold justify-content-between text-dark">
                            <span>TOTAL PRICE</span>
                            <span>$45</span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <div id="paypal-payment-button" class="col-lg-6">Pay with <img src="~/images/PayPal.png"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>

    <fieldset id="divRequestSuccesss" class="inActive">
        <div class="centertextdiv justify-content-start fieldset4">
            <div class="container-fluid h-100">
                <div class="row full_height">
                    <div class="col-lg-4 leftdiscription">
                        <div class="leftdiscription_inner">
                            <h2 class="desc_heading">Myavana Hair Coaching Session</h2>
                            <ul class="disc_list" id="disc_list">
                                <li>
                                    30 min
                                </li>
                                <li>
                                    Web conferencing details provided upon confirmation.
                                </li>
                                <li>
                                    $45 USD
                                </li>
                                <li>
                                    10:00-10:30, Friday, August 12, 2021
                                </li>
                                <li>
                                    Atlanta Time(GMT-4)
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-8 form_div">
                        <div class="scusses_msg">
                            <div class="tick_icon">

                            </div>
                            <h2 class="font-bold">
                                Your Request is Successful!
                            </h2>
                            <p class="mb-2">We will contact you soon.</p>
                            @*<a asp-controller="HairProfile" asp-action="CustomerHair" class="form_btn w-auto pl-4 pr-4">Done</a>*@
                            <button type="button" onclick="redirectTo();" class="form_btn w-auto pl-4 pr-4">Done</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>

</div>
<script src="https://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>

<script>
    $(function () {
        $("#datepicker").datepicker({ firstDay: 1 });
    });
</script>
<script src="https://www.paypal.com/sdk/js?client-id=Ac0H7GnbntqeN5xYWpMSGxq-NfrDVuADbG0hTLZIRIjpPoUvt76YXP895KjZ4AZVTAw5W-RSoGbJlFd5&enable-funding=venmo&currency=INR" data-sdk-integration-source="button-factory""></script>
<script>
    paypal.Buttons({
        createOrder: function (data, actions) {
            // This function sets up the details of the transaction, including the amount and line item details.
            return actions.order.create({
                //purchase_units: [{
                //    amount: {
                //        value: '45'
                //    }
                //}]
                purchase_units: [{ "amount": { "currency_code": "INR", "value": 1 } }]
            });
        },
        onApprove: function (data, actions) {
            // This function captures the funds from the transaction.
            return actions.order.capture().then(function (details) {
                // This function shows a transaction success message to your buyer.
                alert('Transaction completed by ' + details.payer.name.given_name);
            });
        }
    }).render('#paypal-payment-button');
    //This function displays Smart Payment Buttons on your web page.
</script>
<script>

    //jQuery time
    var check = false;
    var current_fs, next_fs, previous_fs; //fieldsets
    var left, opacity, scale; //fieldset properties which we will animate
    var animating; //flag to prevent quick multi-click glitches
    var i = 1;

    $(".next").click(function () {

        if (animating) return false;
        animating = true;


        current_fs = $(".fieldset" + i).parent();
        next_fs = current_fs.next();
        i++;

        //activate next step on progressbar using the index of next_fs

        $("#progressbar fieldset").eq($("fieldset").index(next_fs)).addClass("active");

        current_fs.addClass("inActive");
        next_fs.removeClass("inActive");
        //show the next fieldset
        next_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now, mx) {
                //as the opacity of current_fs reduces to 0 - stored in "now"
                //1. scale current_fs down to 80%
                scale = 1 - (1 - now) * 0.2;
                //2. bring next_fs from the right(50%)
                left = (now * 50) + "%";
                //3. increase opacity of next_fs to 1 as it moves in
                opacity = 1 - now;
                current_fs.css({
                    'transform': 'scale(' + scale + ')',
                    'position': 'absolute'
                });
                next_fs.css({ 'left': left, 'opacity': opacity });
            },
            duration: 1800,
            complete: function () {
                current_fs.hide();
                animating = false;
            },
            //this comes from the custom easing plugin
            easing: 'easeInOutBack'
        });
    }
    );

    $(".previous").click(function () {
        if (animating) return false;
        animating = true;

        current_fs = $(".fieldset" + i).parent();
        previous_fs = current_fs.prev();

        current_fs.addClass("inActive");
        previous_fs.removeClass("inActive");
        i--;
        //de-activate current step on progressbar
        //$("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

        //show the previous fieldset
        previous_fs.show();
        //hide the current fieldset with style
        current_fs.animate({ opacity: 0 }, {
            step: function (now, mx) {
                //as the opacity of current_fs reduces to 0 - stored in "now"
                //1. scale previous_fs from 80% to 100%
                scale = 0.8 + (1 - now) * 0.2;
                //2. take current_fs to the right(50%) - from 0%
                left = ((1 - now) * 50) + "%";
                //3. increase opacity of previous_fs to 1 as it moves in
                opacity = 1 - now;
                current_fs.css({ 'left': left });
                previous_fs.css({ 'transform': 'scale(' + scale + ')', 'opacity': opacity });
            },
            duration: 800,
            complete: function () {
                current_fs.hide();
                animating = false;
            },
            //this comes from the custom easing plugin
            easing: 'easeInOutBack'
        });
    });

    $(".valchangeonconfirm").click(function () {
        var a = $("#datetimetext").html();
        var ele = document.getElementsByName('optionsTimeslots');
        var ele1 = document.getElementsByName('difftimezones');
        for (var i = 0; i < ele1.length; i++) {
            if (ele1[i].selected) {
                $("#Timezonetext").html(ele1[i].value);
                $("#Timezonetext1").html(ele1[i].value);
            }
        }
        for (var i = 0; i < ele.length; i++) {
            if (ele[i].checked) {
                let hours = parseInt(ele[i].value.split(':')[0]);
                let minutes = parseInt(ele[i].value.split(':')[1]);
                minutes += 30;
                // if an hour is exceeded, add it to hours instead
                // and account for a day passing by
                if (minutes >= 60) {
                    hours = (hours + 1) % 24;
                    minutes -= 60;
                }
                // reformat values as strings with a fix length of 2
                hours = (hours < 10 ? `0${hours}` : `${hours}`);
                minutes = (minutes < 10 ? `0${minutes}` : `${minutes}`);
                // assign new value to the end input
                const end = `${hours}:${minutes}`;
                $("#resultdatetimezone").html(ele[i].value + "-" + end + ", " + a);
                $("#resultdatetimezone1").html(ele[i].value + "-" + end + ", " + a);
                timeslot = 1;
            }
        }
    });
</script>

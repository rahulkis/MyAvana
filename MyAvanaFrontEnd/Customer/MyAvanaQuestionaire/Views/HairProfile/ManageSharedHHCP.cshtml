@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper AuthoringTagHelpers.TagHelpers.EmailTagHelper, AuthoringTagHelpers
@using Microsoft.AspNetCore.Http
@using DataTables.AspNetCore.Mvc
@model MyAvanaQuestionaireModel.SharedHHCPModel
@inject MyAvanaQuestionaireApiClient.ApiClient apiClient
@{
    Layout = "_Layout";


}
<link href="~/css/styleCustomer.css" rel="stylesheet" />
<link href="~/css/owl.carousel.min.css" rel="stylesheet" />
<link href="~/css/owl.theme.default.css" rel="stylesheet" />
<link href="~/css/jquery.nailthumb.1.1.min.css" rel="stylesheet" type="text/css">
<script src="~/js/shadowbox.js"></script>
<script src="~/js/jquery.nailthumb.1.1.min.js"></script>

<link href="~/css/shadowbox.css" rel="stylesheet" />


<style>

    .alert-success, .alert-danger, .alert-info {
        top: 110px !important;
        width: 60% !important;
        margin: 0 auto;
        z-index: 99;
        position: fixed;
        left: 50%;
        transform: translateX(-40%);
        text-align: center;
        padding: 12px;
        transition: all 1s linear;
        box-shadow: 0px 0px 12px 3px rgba(0, 0, 0, 0.2);
        font-size: 16px;
    }

    .txtFormat {
        white-space: pre-line;
        white-space: pre-wrap;
        border: none;
    }

        .txtFormat:focus {
            outline: none;
        }

    .alert-danger {
        color: #80172a;
        background-color: #fdd5dc;
        border-color: #fcc4ce;
    }

        .alert-danger hr {
            border-top-color: #fbacba;
        }

        .alert-danger .alert-link {
            color: #550f1c;
        }

    .alert-success {
        color: #1c6356;
        background-color: #a8ffc3;
        border-color: #13b755;
    }

        .alert-success hr {
            border-top-color: #b4e7dd;
        }

        .alert-success .alert-link {
            color: #113b33;
        }

    .select2-container, .select2-container li.select2-search {
        width: 100% !important;
    }

    .preloader {
        width: 100%;
        height: 100%;
        top: 0px;
        position: fixed;
        z-index: 99999;
        background: rgba(255, 255, 255, .8);
    }

        .preloader img {
            position: absolute;
            LEFT: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
        }

    .loader {
        overflow: visible;
        padding-top: 2em;
        height: 0;
        width: 2em;
    }

    .centertextdiv {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: calc(100% - 80px);
    }

        .centertextdiv a {
            background: #ffdede;
            padding: 7px 15px;
            color: #383838;
            border-radius: 4px;
            border: 1px solid #ffbaba;
            text-transform: uppercase;
        }

            .centertextdiv a:hover {
                background: #383838;
                color: #ffdede;
                border: 1px solid #ffdede;
            }

        .centertextdiv p {
            font-size: 16px;
            margin-bottom: 30px;
        }

    .accordion-toggle:after {
        font-family: 'FontAwesome';
        content: "\f078";
        float: right;
    }

    .accordion-opened .accordion-toggle:after {
        content: "\f054";
    }

    #accordion2 .accordion-heading {
        padding: 6px 15px;
        margin-bottom: 5px;
        border-radius: 4px;
    }

    .products_tab .nav-link.active {
        background: #756966;
    }

    .products_tab .nav-link {
        color: #756966;
    }

        .products_tab .nav-link:hover {
            background: #756966;
            color: #fff;
        }

    .listhead {
        border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
        margin-bottom: 20px;
    }

    .boservationsubparts {
        display: flex;
        align-items: baseline;
    }

        .boservationsubparts h4 {
            width: 30%;
            text-align: right;
        }

    .Observations .boservationsubparts p {
        background: #ffefee;
        padding: 10px 15px;
        border-radius: 4px;
        margin-left: 10px;
    }

    .Porositynelasticity {
        border-top: 1px solid #ccc;
        padding-top: 20px;
        margin-top: 20px;
    }

    .stylistcrousel .hairsteps {
        box-shadow: 0 1px 6px 0 rgba(32, 33, 36, .28);
        left: 0;
        padding: 15px;
        border-radius: 4px;
        background: #eee;
    }

        .stylistcrousel .hairsteps p {
            word-break: break-word;
        }

    .textFormat {
        white-space: pre-wrap;
    }

    .table-id-data th {
        width: 90px;
    }

    .demo {
        width: 150px;
        height: 150px;
        background-position: center center;
        background-repeat: no-repeat;
        display: inline-block;
    }

    .tab-section {
        padding: 20px 0;
    }

        .tab-section .nav-pills .nav-link.active {
            background: #E9C6C6;
            color: #383838;
            font-weight: bold;
        }

        .tab-section .nav-pills .nav-link {
            color: #707070;
            font-size: 18px;
            position: relative;
            border: none;
            width: 19%;
            /*background: #d8d9e3;*/
            margin-left: 1%;
            border-radius: 3px;
            text-align: center;
            line-height: normal;
            padding: 10px;
            min-height: 58px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .tab-section .nav-pills .nav-link:first-child {
                margin-left: 0;
            }

    /*.tab-section .nav-pills .nav-link.active:after {
                content: "";
                position: absolute;
                bottom: -7px;
                left: 50%;
                transform: translateX(-50%);
                width: 0;
                height: 0;
                border-left: 7px solid transparent;
                border-right: 7px solid transparent;
                border-top: 7px solid #6d7071;
                background: transparent;
            }*/
    @@media screen and (max-width:767px) {
        .tab-section .nav-pills .nav-link {
            width: calc(50% - 10px);
            margin: 5px;
            font-size: 16px;
        }
    }

    .products_tab .nav .nav-link {
        width: 100%;
        margin-bottom: 15px;
    }

        .products_tab .nav .nav-link.active:after {
            content: "";
            position: absolute;
            top: 50%;
            left: auto;
            right: -10px;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 7px solid transparent;
            border-right: 7px solid transparent;
            border-top: 7px solid #6d7071;
            background: transparent;
            transform: rotate( -90deg );
        }

    .hair_analyst_notes {
        border: 1px solid #d8dfeb;
        padding: 10px;
        height: 100px;
        overflow: auto;
    }

    @@media screen and (max-width:767px) {
        .tab-section .nav-pills .nav-link {
            width: calc(50% - 10px);
            margin: 5px;
            font-size: 16px;
        }
    }
</style>
<div id="alert-success" class="alert alert-success alert-dismissible" style="display:none; width:50%" data-keyboard="false" data-backdrop="static">
    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    <span id="successMessage"></span>
</div>
<div class="alert alert-danger alert-dismissible" style="display:none; width:50%" data-keyboard="false" data-backdrop="static">
    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    <span id="failureMessage"></span>
</div>

<div class="preloader" style="display:none;">
    <div class="loader">
        <img src="~/images/loader.gif" />
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox ">
                <div class="ibox-title pr-0">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Manage Shared HHCP</h5>
                        </div>
                        <div class="col-md-6 text-md-right">
                            <div class="addnewbtn pr-3"><span class="align-right"><a class="btn dark-btn" onclick="openEmailModal()">Share HHCP</a></span></div>
                        </div>
                        </div>
                        
                    </div>
                <div class="ibox-content">
                    @(Html.Ext().Grid<MyAvanaQuestionaireModel.SharedHHCPModel>
                            ().Name("SharedHHCPList")
                            .Columns(cols =>
                            {
                                cols.Add(c => c.HHCPName).Title("HHCP");
                                cols.Add(c => c.SharedWith).Title("SharedWithUserId").Visible(false);
                                cols.Add(c => c.SharedWithUser).Title("Shared With");
                                cols.Add(c => c.SharedOn).Title("Shared On");
                                cols.Add(c => c.RevokedOn).Title("Revoked On").Render(() => "formatRevokedOn");
                                cols.Add(c => c.Id).Render(() => "onRender").Title("Actions");
                            })
                            .ServerSide(false)
                            .Ordering(false)
                            .Paging(true)
                            .Searching(true)
                            .Info(false)
                            .DataSource(c =>
                            c.Ajax().Url("GetSharedHHCPList").Method("Get")
                            )
                        )
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="confirmRevokeModal" tabindex="-1" role="dialog" aria-labelledby="confirmModal" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="confirmModalHeader" class="font-bold">Revoke Access</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <span id="confirmRevokeModalText"></span>
                <span class="text-danger mt-2 d-block text-center" id="revokeValidation">
                    <span id="revokeError"></span>
                </span>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelChangeMethod" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmRevokeMethod">Revoke</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="emailModal" tabindex="-1" role="dialog" aria-labelledby="emailModalLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="emailModalLabel">Share HHCP</h3>

                <button type="button" class="close" onclick="Clearfileds()" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
               
            </div>
            <div class="modal-body">
                <p class="share_discription">Enter the email of the person whom you would like to share your Healthy Hair Care Plan (HHCP) with. Note that the person must already have an active MYAVANA account before you can share your HHCP.</p>
                <label>Hair Profile: </label>
                <select class="form-control w-auto" id="ddlHHCP" style="width:100%!important"
                        asp-items="@apiClient.GetHHCPList(Model.UserEmail).Result.Select(a => new SelectListItem() { Text = a.HairProfile, Value=a.HairProfileId.ToString()})"></select>
                <br />
                <label>Email: </label>
                <input type="text" class="form-control" id="emailInput" placeholder="Enter email here" />
                <span id="emailValidationMessage" class="text-danger" style="display: none;"></span>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelButton" onclick="Clearfileds()" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="shareButton">Share</button>
            </div>
        </div>
    </div>
</div>
<script src="~/js/ManageSharedHHCP.js"></script>